<app-navbar></app-navbar>

<div class="loader_bg" *ngIf="isLoading === true">
    <div class="loader"><img src="./assets/images/loading.gif" alt="#" /></div>
</div>


<section id="vehicles" class="vehicles" style="height: 70%;">

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="titlepage">
                    <h2>Les diagnostics du véhicule</h2>
                    <p>Détails des diagnostics faits par le garage.</p>
                    <p>{{message}}</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container px-0">
        <div class="row mt-4">
            <div class="col-12 col-lg-12">

                <hr class="row brc-default-l1 mx-n1 mb-4" />

                <div class="row">

                    <div class="col-sm-6">
                        <div>
                            <span class="text-sm text-grey-m2 align-middle" style="font-size: 135%;">Client: </span>
                            <span class="text-blue align-middle" style="font-size: 135%;">{{invoice.clientName}}
                                {{invoice.clientSurname}}</span>
                        </div>
                        <div class="text-grey-m2">
                            <div class="my-1"><i class="fa fa-phone  text-secondary"></i> <b class="text-600"
                                    style="font-size: 135%;"> {{invoice.clientContact}}</b></div>
                        </div>
                        <div>
                            <span class="text-sm text-grey-m2 align-middle" style="font-size: 135%;">Véhicule: </span>
                            <span class="text-blue align-middle" style="font-size: 135%;">{{invoice.carMark}}
                                {{invoice.carModel}}</span>
                        </div>
                        <div>
                            <span class="text-sm text-grey-m2 align-middle" style="font-size: 135%;">Matricule: </span>
                            <span class="text-blue align-middle" style="font-size: 135%;">{{invoice.numberPlate}}</span>
                        </div>
                    </div>



                    <div class="text-95 col-sm-6 align-self-start d-sm-flex justify-content-end">
                        <hr class="d-sm-none" />

                        <div class="text-grey-m2">
                            <div>
                                <span class="text-sm text-grey-m2 align-middle" style="font-size: 135%;">Vendeur:
                                </span>
                                <span class="text-blue align-middle" style="font-size: 135%;">{{invoice.userName}}
                                    {{invoice.userSurname}}</span>
                            </div>

                            <div>
                                <span class="text-sm text-grey-m2 align-middle" style="font-size: 135%;">Garage: </span>
                                <span class="text-blue align-middle" style="font-size: 135%;">{{invoice.garageName}}
                                    {{invoice.garageLocation}}</span>
                            </div>

                            <div class="my-1"><i class="fa fa-phone text-secondary"></i> <b class="text-600"
                                    style="font-size: 135%;"> {{invoice.userContact}}</b></div>

                            <!-- <div class="my-2" style="font-size: 135%;"><i class="fa fa-circle text-blue-m2 text-xs mr-1"></i> <span class="text-600 text-90">Issue Date:</span> Oct 12, 2019</div> -->

                            <!-- <div class="my-2" style="font-size: 135%;" *ngIf="invoice.status === 'EnAttente'">
                                <i class="fa fa-circle text-blue-m2 text-xs mr-1"></i> 
                                <span class="text-600 text-90 mr-2">Status:</span> 
                                <span class="badge badge-secondary badge-pill px-25"> {{invoice.status}}</span>
                            </div> -->

                            <div class="my-2" style="font-size: 135%;" *ngIf="invoice.status === 'NonPayer'">
                                <i class="fa fa-circle text-blue-m2 text-xs mr-1"></i>
                                <span class="text-600 text-90 mr-2">Status:</span>
                                <span class="badge badge-danger badge-pill px-25"> {{invoice.status}}</span>
                            </div>

                            <div class="my-2" style="font-size: 135%;" *ngIf="invoice.status === 'Payer'">
                                <i class="fa fa-circle text-blue-m2 text-xs mr-1"></i>
                                <span class="text-600 text-90 mr-2">Status:</span>
                                <span class="badge badge-success badge-pill px-25"> {{invoice.status}}</span>
                            </div>

                            <!-- <div class="my-2" style="font-size: 135%;" *ngIf="invoice.status === 'Refuser'">
                                <i class="fa fa-circle text-blue-m2 text-xs mr-1"></i> 
                                <span class="text-600 text-90 mr-2">Status:</span> 
                                <span class="badge badge-danger badge-pill px-25"> {{invoice.status}}</span>
                            </div> -->

                        </div>
                    </div>

                </div>

                <div class="mt-4">

                    <div class="row text-600 text-white bgc-default-tp1 py-25" style="font-size: 135%;">
                        <div class="col-lg-9 col-sm-5">Description</div>
                        <div class="d-none d-sm-block col-2 text-95">Prix</div>
                    </div>

                    <div class="text-95 text-secondary-d3" style="font-size: 135%;"
                        *ngFor="let cp of invoice.carProblem">

                        <div class="row mb-2 mb-sm-0 py-25 bgc-default-l4">
                            <div class="col-lg-9 col-sm-5">{{cp.entitled}}</div>
                            <div class="d-none d-sm-block col-2 text-95">{{cp.price| number:'1.0-3'}} Ar</div>
                        </div>

                    </div>

                    <div class="row border-b-2 brc-default-l2"></div>


                    <div class="row mt-3">
                        <div class="col-12 col-sm-7 text-grey-d2 text-95 mt-2 mt-lg-0">
                        </div>

                        <div class="col-12 col-sm-5 text-grey text-90 order-first order-sm-last">


                            <div class="row my-2 align-items-center bgc-primary-l3 p-2">
                                <div class="col-7 text-right" style="font-size: large; font-weight: bold;">
                                    Montant total
                                </div>
                                <div class="col-5">
                                    <span class="text-150 text-success-d3 opacity-2">{{invoice.amount| number:'1.0-3'}}
                                        Ar</span>
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- <div style="display: flex;justify-content: center;" *ngIf="me.role === 'client' && invoice.status === 'EnAttente'">
                        <button type="button" class="btn btn-success mr-2">Accepter</button>
                        <button type="button" class="btn btn-danger">Refuser</button>
                    </div> -->

                    <div style="display: flex;justify-content: center;"
                        *ngIf="me.role === 'respfinance' && invoice.status === 'NonPayer'">
                        <button type="button" (click)="validPayment()" class="btn btn-success mr-2">Valider
                            paiement</button>
                    </div>

                </div>
            </div>
        </div>
    </div>

</section>